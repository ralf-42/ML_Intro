<!-- MathJax Support für mathematische Formeln -->
<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      ignoreHtmlClass: 'tex2jax_ignore',
      processHtmlClass: 'tex2jax_process'
    }
  };
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>

<!-- Mermaid Diagramm Support -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
  mermaid.initialize({
    startOnLoad: true,
    theme: 'default',
    securityLevel: 'loose',
    flowchart: {
      htmlLabels: true,
      curve: 'basis'
    }
  });
</script>

<!-- Callout Transformation Script -->
<script src="{{ '/assets/js/callouts.js' | relative_url }}"></script>

<!-- Externe Links in neuem Tab öffnen -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Alle Links auf der Seite finden
    const links = document.querySelectorAll('a[href]');

    links.forEach(function(link) {
      const href = link.getAttribute('href');

      // Prüfen ob es ein externer Link ist
      // (beginnt mit http/https und zeigt nicht auf die eigene Domain)
      if (href && (href.startsWith('http://') || href.startsWith('https://'))) {
        const currentDomain = window.location.hostname;

        try {
          const linkUrl = new URL(href);
          // Wenn der Link auf eine andere Domain zeigt
          if (linkUrl.hostname !== currentDomain) {
            link.setAttribute('target', '_blank');
            link.setAttribute('rel', 'noopener noreferrer');
          }
        } catch (e) {
          // Falls URL-Parsing fehlschlägt, Link trotzdem in neuem Tab öffnen
          link.setAttribute('target', '_blank');
          link.setAttribute('rel', 'noopener noreferrer');
        }
      }
    });
  });
</script>
